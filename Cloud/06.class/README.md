# Azure 가용성과 아키텍처 구성요소

> Azure 서비스 가용성을 극대화하기 위한 기술과 Azure 아키텍처 구성요소를 이해

---

## 1) Critical 환경 분류
### Mission-critical environments
- 오동작 시 **사람의 생명에 영향을 미치는** 시스템/서비스
- 예: 원자력 발전소 관제 시스템, 항공 관제 시스템, 119 응급 콜센터

### Business-critical environments
- 오동작 시 **회사 수익/생산성에 영향을 미치는** 시스템/서비스
- 예: 인트라넷 전자결재 시스템, 전자상거래 사이트

---

## 2) 가용성(Availability)

### 개념
- 궁극적인 목적: 시스템에 오류가 발생해도 **7일 24시간 지속적으로 서비스 제공**

### 가용성 계산(연간 기준)
- 공식:
  - **가용성(%) = (my - mf) × 100 / my**
  - my = 365 × 24 × 60 (1년을 분 단위로 환산)
  - mf = 1년 중 **오류로 인해 서비스가 정지된 시간(분)**
- mf 계산 시 **계획된 유지보수로 인한 중단 시간은 제외**

### 예시
- 1년 동안 총 서비스 다운이 **52.5분**이라면  
  - 가용성 = (525600 - 52.5) × 100 / 525600  = **99.99%**
- 즉, 이 시스템이 제공하는 서비스의 가용성은 **99.99%**

### Five 9s
- Mission critical: **99.999%**
- Business critical: **99.9% ~ 99.99%** 요구

---

## 3) MTBF / MTTR 기반 가용성

### 용어
- **MTBF(Mean Time Between Failures)**: 평균 고장 간격(의미 있는 “정상 동작 시간”)
- **MTTR(Mean Time To Repair)**: 평균 복구 시간

### 공식
- **가용성 = MTBF × 100 / (MTBF + MTTR)**

### 예시
- 특정 시스템이 **10,000시간** 오류 없이 동작하다가 오류 발생 후 복구에 **2시간**이 소요되었다면  
  - 가용성 = 10000 × 100 / (10000 + 2) = **99.98%**

### 가용성 향상 관점
- 가용성을 높이기 위해서는 **신뢰성이 높은 하드웨어/소프트웨어 구매**가 중요

---

## 4) 내결함성(Fault Tolerance)

### 개념
- 시스템을 구성하는 하드웨어나 소프트웨어에 오류가 발생해도 **지속적으로 서비스를 제공할 수 있는 능력**

### 하드웨어 내결함성 예시
- 하드디스크: RAID 1, RAID 5
- 네트워크 카드: Dual NIC / Network Teaming
- RAM: RAID Memory
- 전원 공급 장치: UPS

### IaaS 관점
- 하드웨어적인 요소들을 빌려 쓰면서 내결함성을 지원하는 개념 = **HaaS(Hardware as a Service)**

### 소프트웨어 내결함성 예시
- 운영체제 오류: **서버 클러스터** 구성

---

## 5) 가용성 집합(Availability Set)

### 개념/효과
- 가용성 집합에 포함된 각각의 VM은 **업데이트 도메인(Update Domain)** 및 **장애 도메인(Fault Domain)**에 할당됨
- VM 유지관리 또는 하드웨어 오류 상황에서도 애플리케이션을 **지속적으로 제공**할 수 있게 하는 솔루션

### SLA
- 가용성 집합으로 그룹화된 VM은 **99.95% SLA**(서비스 준수 계약)

### 구성 특징
- 가용성 집합 내 최대 **100대**의 VM 가능
- 가용성 집합은 아래 2개 개념을 포함한다:

#### Fault Domain (Rack)
- 오류에서 VM을 격리
- Azure 데이터센터 내 여러 하드웨어에서 오류가 발생하더라도 워크로드를 **물리적으로 분리**

#### Update Domain
- 물리적인 호스트 업데이트로부터 VM을 격리
- 예약된 유지관리/성능/보안 업데이트는 업데이트 도메인을 통해 **순서가 결정**
- 기본 5개에서 최대 12개까지 가능
- VM은 Hypervisor를 통해 **안전하게 재부팅**

---

## 6) 가용성 옵션에 따른 Azure 토폴로지 구성 요소

### 지리적 위치(Geography)
- 지정학적 경계(규제, 세금) 기준
- 고객 데이터는 고객의 지리적 위치에 유지
- 과세는 지리적 위치에 따라 다양함

### 지역(Region)
- 하나 이상의 데이터센터(DC)를 근접한 위치에 가진 사이트
- 지역 간 재해에 대한 고립
- 비동기식 복제를 위한 지역 지연 고려
- 다른 지역의 계산을 독립적으로 관리

### Fault Domain
- 전원/네트워크 같은 물리 리소스를 공유하는 서버 집합(랙)
- 다른 FD 간 상호 연관된 오류 발생 개연성을 낮춤
- 여러 FD 간 2개 이상의 인스턴스를 요구하는 계산 수행에 유리

### Update Domain
- VM 내 SW 요소가 동시에 업데이트되는 VM 인스턴스의 그룹
- 한 번에 하나의 UD만 업데이트
- 여러 UD 간 2개 이상의 인스턴스를 요구하는 계산 수행에 유리

---

## 7) 리소스 그룹(Resource Group)
- 동일한 수명주기를 갖는 리소스들의 묶음
- 리소스는 리소스 그룹으로 이동할 수 있음
- 리소스는 **하나의 리소스 그룹에 소속**
- 역할 기반(RBAC)을 사용하여 리소스/그룹 레벨 보안 유지

---

## 8) 리소스 매니저(Azure Resource Manager)
- Azure를 관리하는 계층
- 리소스 또는 리소스 그룹을 생성/구성/관리/삭제
- 리소스 조직화 및 자동화
- Azure AD를 통한 접근 제어
- 관리 도구: Azure Portal, CLI, PowerShell, API

---

## 요약
- IT 인프라 관련 **가용성/내결함성** 용어와 의미 학습
- Azure 서비스 가용성 극대화 기술로 **가용성 집합, 가용 영역** 및 고가용성 구현 사례를 학습
- Azure 아키텍처 구성요소인 **리소스 그룹(Resource Group)** 과 **리소스 매니저(ARM)** 를 학습
